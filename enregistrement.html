<!DOCTYPE html> 
<html lang="fr">
    <head>
        <meta charset="UTF-8">
        <title>page de connexion</title>
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.1/css/all.min.css">
        <link rel="stylesheet" href="style.css">
    </head>
    <body>
        <form class="enregistrement" id="registre">
            <h2>Enregistrement</h2>
            <i class="fa-regular fa-user"></i>
            <label for="nom">Nom</label>
            <input id="nom" type="text" placeholder="Ex:Ilunga"><br>
            <i class="fa-regular fa-user"></i>
            <label for="postnom">Postnom</label>
            <input id="postnom" type="text"placeholder="Ex:Mwauka">
            <br>
            <i class="fa-regular fa-user"></i>
            <label for="prenom">Prenom</label>
            <input id="prenom" type="text"placeholder="Ex:Agnes">
            <br>
            <i class="fa-solid fa-building"></i>
            <label for="firm">Entreprise</label>
            <input id="firm" type="text"placeholder="Mashup SARL">
            <br>
            <i class="fa-solid fa-building"></i>
            <label for="job">Poste</label>
            <input id="job" type="text"placeholder="Mashup SARL">
            <br>
            <i class="fa-solid fa-phone"></i>
            <label for="tel">Téléphone</label>
            <input id="tel" type="tel"placeholder="EX:+2439000766">
            <br>
            <i class="fa-regular fa-envelope"></i>
            <label for="e-mail">E-mail</label>
            <input id="mail" type="email"placeholder="Ex:agnesmwauka@gmail.com">
            <br>
            <i class="fa-solid fa-image"></i>
            <label for="photo"></label>
            <input id="photo" type="file">
            <br>
            <i class="fa-solid fa-lock"></i>
            <label for="password">créer un mot de passe</label>
            <input id="password" type="password" required="required" placeholder="*****">
            <br>
            <i class="fa-solid fa-lock"></i>
            <label for="password">confirmer le mot de passe</label>
            <input id="password" type="password" required="required" placeholder="*****">
            <br>
            <button type="submit">créer</button>
            <br>
            <p> vous avez déjà un compte?<a href="connexion.html" class="login">se connecter</a></p>
        </form>
            <script>
                    function loadProfile() {
                    const userData = JSON.parse(localStorage.getItem("userData"));
                    if (userData) {
                        document.getElementById("photo").src = userData.photo || "";
                        document.getElementById("nom").innerText = "Nom :" + userData.nom;
                        document.getElementById("postnom").innerText = "Postnom :" + userData.postnom;
                        document.getElementById("prenom").innerText = "Prenom :" + userData.prenom; 
                        document.getElementById("firm").innerText = "Entreprise :" + userData.firm;
                        document.getElementById("job").innerText = "Poste :" + userData.job;
                        document.getElementById("tel").innerText = "Téléphone :" + userData.tel;
                        document.getElementById("mail").innerText ="Email :" + userData.mail
                        document.getElementById("password").innerText ="Mot de passe :" +userData.password;
                    }
                     window.location.href = 'profil.html';
                }
                    
                document.getElementById("editBtn").addEventListener("click", () => {
                    const userData = JSON.parse(localStorage.getItem("userData"));
                    if (!userData) return;

                    document.getElementById("editphoto").Value=userData.photo || "";
                    document.getElementById("editnom").textContent= sessionStorage.getItem("nom");
                    document.getElementById("editpostnom").Value =  userData.postnom;
                    document.getElementById("editprenom").Value = userData.prenom; 
                    document.getElementById("editfirm").Value = userData.firm;
                    document.getElementById("editjob").Value = userData.job;
                    document.getElementById("edittel").Value = userData.tel;
                    document.getElementById("editmail").Value = userData.mail;
                    document.getElementById("editpassword").Value = userData.password;
                    document.getElementById("editForm").style.display = "block";
                });
                document.getElementById("saveChanges").addEventListener("click", () =>{
                    const photo = document.getElementById("editphoto").files[0];
                    const nom = document.getElementById("editnom").value ;
                    const postnom =   document.getElementById("editpostnom").value ;
                    const prenom =   document.getElementById("editprenom").value ; 
                    const firm =  document.getElementById("editfirm").value ;
                    const job =   document.getElementById("editjob").value ;
                    const tel =   document.getElementById("edittel").value ;
                    const mail =   document.getElementById("editmail").value;
                    const password =   document.getElementById("editpassword").Value ;
                    const savedata = (photoBase64) => {
                        const updateUser = {
                            nom,
                            postnom,
                            prenom,
                            firm,
                            job,
                            tel,
                            mail,
                            password,
                            photo: photoBase64,
                        };
                        localStorage.setItem("userData", JSON.stringify(updateUser));
                        alert("Informations mises à jour.");
                        location.reload();
                    };
                    if (photo) {
                        const reader = new FileReader();
                        reader.onload = () => savedata(reader.result);
                        reader.readAsDataURL(photo);
                    }
                    else {
                        const userData = JSON.parse(localStorage.getItem("userData"));
                        savedata(userData.photo || "")
                    }
                });
                window.onload = loadProfile;
                window.location.href = 'profil.html';
            </script>
    </body>

</html>

